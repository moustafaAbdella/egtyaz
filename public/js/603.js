/*! For license information please see 603.js.LICENSE.txt */
"use strict";(self.webpackChunklaravue=self.webpackChunklaravue||[]).push([[603],{571:(e,t,n)=>{n.d(t,{A:()=>d});var r=n(5751);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:t+""}function a(e,t,n){return t=c(t),function(e,t){if(t&&("object"==i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,l()?Reflect.construct(t,n||[],c(e).constructor):t.apply(e,n))}function l(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(l=function(){return!!e})()}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}var d=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a(this,t,["roles"])}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(t,e),n=t,(i=[{key:"permissions",value:function(e){return(0,r.A)({url:"/"+this.uri+"/"+e+"/permissions",method:"get"})}},{key:"destroy",value:function(e){return(0,r.A)({url:"/"+this.uri+"/"+e,method:"delete"})}}])&&o(n.prototype,i),s&&o(n,s),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,i,s}(n(1527).A)},1527:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(5751);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:t+""}var a=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.uri=t},(t=[{key:"list",value:function(e){return(0,r.A)({url:"/"+this.uri,method:"get",params:e})}},{key:"get",value:function(e){return(0,r.A)({url:"/"+this.uri+"/"+e,method:"get"})}},{key:"store",value:function(e){return(0,r.A)({url:"/"+this.uri,method:"post",data:e})}},{key:"update",value:function(e,t){return(0,r.A)({url:"/"+this.uri+"/"+e,method:"put",data:t})}},{key:"destroy",value:function(e){return(0,r.A)({url:"/"+this.uri+"/"+e,method:"delete"})}},{key:"active",value:function(e,t,n){return(0,r.A)({url:"/"+this.uri+"/active/"+n,method:"post",data:{status:t}})}},{key:"select",value:function(e){return(0,r.A)({url:"/"+this.uri+"/select",method:"get",params:e})}},{key:"selectByType",value:function(e){return(0,r.A)({url:"/"+this.uri+"/select/"+e,method:"get"})}}])&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}()},3158:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(6798),i=n.n(r)()(function(e){return e[1]});i.push([e.id,".waves-ripple{background-clip:padding-box;background-color:rgba(0,0,0,.15);border-radius:100%;opacity:1;pointer-events:none;position:absolute;transform:scale(0);-webkit-user-select:none;-moz-user-select:none;user-select:none}.waves-ripple.z-active{opacity:0;transform:scale(2);transition:opacity 1.2s ease-out,transform .6s ease-out}",""]);const o=i},4725:(e,t,n)=>{n.d(t,{A:()=>d});var r=n(5072),i=n.n(r),o=n(3158),s={insert:"head",singleton:!1};i()(o.A,s);o.A.locals;var a="@@wavesContext";function l(e,t){function n(n){var r=Object.assign({},t.value),i=Object.assign({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},r),o=i.ele;if(o){o.style.position="relative",o.style.overflow="hidden";var s=o.getBoundingClientRect(),a=o.querySelector(".waves-ripple");if(a?a.className="waves-ripple":((a=document.createElement("span")).className="waves-ripple",a.style.height=a.style.width=Math.max(s.width,s.height)+"px",o.appendChild(a)),"center"===i.type)a.style.top=s.height/2-a.offsetHeight/2+"px",a.style.left=s.width/2-a.offsetWidth/2+"px";else a.style.top=(n.pageY-s.top-a.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",a.style.left=(n.pageX-s.left-a.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px";return a.style.backgroundColor=i.color,a.className="waves-ripple z-active",!1}}return e[a]?e[a].removeHandle=n:e[a]={removeHandle:n},n}const c={bind:function(e,t){e.addEventListener("click",l(e,t),!1)},update:function(e,t){e.removeEventListener("click",e[a].removeHandle,!1),e.addEventListener("click",l(e,t),!1)},unbind:function(e){e.removeEventListener("click",e[a].removeHandle,!1),e[a]=null,delete e[a]}};var u=function(e){e.directive("waves",c)};window.Vue&&(window.waves=c,Vue.use(u)),c.install=u;const d=c},6603:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var r=n(1527),i=n(571),o=n(4725),s=n(9884),a=n(9919);function l(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var l=r&&r.prototype instanceof a?r:a,u=Object.create(l.prototype);return c(u,"_invoke",function(n,r,i){var o,a,l,c=0,u=i||[],d=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return o=t,a=0,l=e,f.n=n,s}};function m(n,r){for(a=n,l=r,t=0;!d&&c&&!i&&t<u.length;t++){var i,o=u[t],m=f.p,p=o[2];n>3?(i=p===r)&&(l=o[(a=o[4])?5:(a=3,3)],o[4]=o[5]=e):o[0]<=m&&((i=n<2&&m<o[1])?(a=0,f.v=r,f.n=o[1]):m<p&&(i=n<3||o[0]>r||r>p)&&(o[4]=n,o[5]=r,f.n=p,a=0))}if(i||n>1)return s;throw d=!0,r}return function(i,u,p){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,p),a=u,l=p;(t=a<2?e:l)||!d;){o||(a?a<3?(a>1&&(f.n=-1),m(a,l)):f.n=l:f.v=l);try{if(c=2,o){if(a||(i="next"),t=o[i]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,a<2&&(a=0)}else 1===a&&(t=o.return)&&t.call(o),a<2&&(l=TypeError("The iterator does not provide a '"+i+"' method"),a=1);o=e}else if((t=(d=f.n<0)?l:n.call(r,f))!==s)break}catch(t){o=e,a=1,l=t}finally{c=1}}return{value:t,done:d}}}(n,i,o),!0),u}var s={};function a(){}function u(){}function d(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(c(t={},r,function(){return this}),t),m=d.prototype=a.prototype=Object.create(f);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,c(e,i,"GeneratorFunction")),e.prototype=Object.create(m),e}return u.prototype=d,c(m,"constructor",d),c(d,"constructor",u),u.displayName="GeneratorFunction",c(d,i,"GeneratorFunction"),c(m),c(m,i,"Generator"),c(m,r,function(){return this}),c(m,"toString",function(){return"[object Generator]"}),(l=function(){return{w:o,m:p}})()}function c(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}c=function(e,t,n,r){function o(t,n){c(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},c(e,t,n,r)}function u(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function d(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function s(e){u(o,r,i,s,a,"next",e)}function a(e){u(o,r,i,s,a,"throw",e)}s(void 0)})}}var f=new i.A,m=new r.A("permissions");const p={name:"RoleList",directives:{waves:o.A,permission:s.A},data:function(){return{currentRoleId:1,list:[],loading:!0,dialogLoading:!1,dialogVisible:!1,addDialogVisible:!1,newRole:{name:""},permissions:[],menuPermissions:[],otherPermissions:[],permissionProps:{children:"children",label:"name",disabled:"disabled"}}},computed:{currentRole:function(){var e=this,t=this.list.find(function(t){return t.id===e.currentRoleId});return void 0===t?{name:"",permissions:[]}:t},rolePermissions:function(){return this.classifyPermissions(this.currentRole.permissions).all},roleMenuPermissions:function(){return this.classifyPermissions(this.currentRole.permissions).menu},roleOtherPermissions:function(){return this.classifyPermissions(this.currentRole.permissions).other}},created:function(){this.getRoles(),this.getPermissions()},methods:{checkPermission:a.A,getRoles:function(){var e=this;return d(l().m(function t(){var n,r;return l().w(function(t){for(;;)switch(t.n){case 0:return e.loading=!0,t.n=1,f.list({});case 1:n=t.v,r=n.data,e.list=r,e.list.forEach(function(t,n){t.index=n+1,t.description=e.$t("roles.description."+t.name)}),e.loading=!1;case 2:return t.a(2)}},t)}))()},getPermissions:function(){var e=this;return d(l().m(function t(){var n,r,i,o,s,a;return l().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,m.list({});case 1:n=t.v,r=n.data,i=e.classifyPermissions(r),o=i.all,s=i.menu,a=i.other,e.permissions=o,e.menuPermissions=s,e.otherPermissions=a;case 2:return t.a(2)}},t)}))()},classifyPermissions:function(e){var t=this,n=[],r=[],i=[];return e.forEach(function(e){var o=e.name;n.push(e),o.startsWith("view menu")?r.push(t.normalizeMenuPermission(e)):i.push(t.normalizePermission(e))}),{all:n,menu:r,other:i}},normalizeMenuPermission:function(e){return{id:e.id,name:this.$options.filters.uppercaseFirst(e.name.substring(10))}},normalizePermission:function(e){return{id:e.id,name:this.$options.filters.uppercaseFirst(e.name),disabled:"manage permission"===e.name}},permissionKeys:function(e){return e.map(function(e){return e.id})},handleEditPermissions:function(e){var t=this;this.dialogVisible=!0,this.currentRoleId=e,this.$nextTick(function(){t.$refs.menuPermissions.setCheckedKeys(t.permissionKeys(t.roleMenuPermissions)),t.$refs.otherPermissions.setCheckedKeys(t.permissionKeys(t.roleOtherPermissions))})},confirmPermission:function(){var e=this,t=this.$refs.menuPermissions.getCheckedKeys(),n=this.$refs.otherPermissions.getCheckedKeys(),r=t.concat(n);this.dialogLoading=!0,f.update(this.currentRole.id,{permissions:r}).then(function(){e.$message.success("Permissions has been updated successfully"),e.dialogLoading=!1,e.dialogVisible=!1,e.getRoles()}).catch(function(){e.dialogLoading=!1})},openAddDialog:function(){var e=this;this.newRole={name:""},this.addDialogVisible=!0,this.$nextTick(function(){e.$refs.newMenuPermissions&&e.$refs.newMenuPermissions.setCheckedKeys([]),e.$refs.newOtherPermissions&&e.$refs.newOtherPermissions.setCheckedKeys([])})},submitNewRole:function(){var e=this;return d(l().m(function t(){var n,r,i;return l().w(function(t){for(;;)switch(t.p=t.n){case 0:if(n=e.$refs.newMenuPermissions?e.$refs.newMenuPermissions.getCheckedKeys():[],r=e.$refs.newOtherPermissions?e.$refs.newOtherPermissions.getCheckedKeys():[],i=n.concat(r),e.newRole.name){t.n=1;break}return e.$message.warning("Role name is required"),t.a(2);case 1:return e.dialogLoading=!0,t.p=2,t.n=3,f.store({name:e.newRole.name,permissions:i});case 3:return e.$message.success("Role created successfully"),e.addDialogVisible=!1,t.n=4,e.getRoles();case 4:t.n=6;break;case 5:t.p=5,t.v,e.$message.error("Failed to create role");case 6:return t.p=6,e.dialogLoading=!1,t.f(6);case 7:return t.a(2)}},t,null,[[2,5,6,7]])}))()},confirmDelete:function(e){var t=this;return d(l().m(function n(){return l().w(function(n){for(;;)switch(n.n){case 0:t.$confirm('Are you sure you want to delete the role "'.concat(e.name,'"?'),"Warning",{confirmButtonText:"Yes",cancelButtonText:"Cancel",type:"warning"}).then(d(l().m(function n(){var r;return l().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,f.destroy(e.id);case 1:t.$message.success("Role deleted successfully"),t.getRoles(),n.n=3;break;case 2:n.p=2,(r=n.v).response&&422===r.response.status?t.$message.error(r.response.data.message||"Role is assigned to users and cannot be deleted"):t.$message.error("Failed to delete role");case 3:return n.a(2)}},n,null,[[0,2]])}))).catch(function(){});case 1:return n.a(2)}},n)}))()}}},v=p;var h=n(5072),y=n.n(h),b=n(7148),g={insert:"head",singleton:!1};y()(b.A,g);b.A.locals;const w=(0,n(4486).A)(v,function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-container"},[t("div",{staticStyle:{"margin-bottom":"16px"}},[t("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.openAddDialog}},[e._v("\n      "+e._s(e.$t("role.addRole")||"Add Role")+"\n    ")])],1),e._v(" "),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.list,border:"",fit:"","highlight-current-row":""}},[t("el-table-column",{attrs:{align:"center",label:"ID",width:"80"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("span",[e._v(e._s(n.row.index))])]}}])}),e._v(" "),t("el-table-column",{attrs:{width:"150",align:"center",label:e.$t("table.name")},scopedSlots:e._u([{key:"default",fn:function(n){return[t("span",[e._v(e._s(e._f("uppercaseFirst")(n.row.name)))])]}}])}),e._v(" "),t("el-table-column",{attrs:{align:"left",label:e.$t("table.description")},scopedSlots:e._u([{key:"default",fn:function(n){return[t("span",[e._v(e._s(n.row.description))])]}}])}),e._v(" "),t("el-table-column",{directives:[{name:"permission",rawName:"v-permission",value:["manage premissions edit"],expression:"['manage premissions edit']"}],attrs:{align:"center",label:"Actions",width:"320"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:function(t){return e.handleEditPermissions(n.row.id)}}},[e._v("\n          "+e._s(e.$t("permission.editPermission"))+"\n        ")]),e._v(" "),t("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete"},on:{click:function(t){return e.confirmDelete(n.row)}}},[e._v("\n          "+e._s(e.$t("role.delete")||"Delete")+"\n        ")])]}}])})],1),e._v(" "),t("el-dialog",{attrs:{visible:e.dialogVisible,title:"Edit Permissions - "+e.currentRole.name},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.dialogLoading,expression:"dialogLoading"}],staticClass:"form-container"},[t("div",{staticClass:"permissions-container"},[t("div",{staticClass:"block"},[t("el-form",{attrs:{model:e.currentRole,"label-width":"80px","label-position":"top"}},[t("el-form-item",{attrs:{label:"Menus"}},[t("el-tree",{ref:"menuPermissions",staticClass:"permission-tree",attrs:{data:e.menuPermissions,"default-checked-keys":e.permissionKeys(e.roleMenuPermissions),props:e.permissionProps,"show-checkbox":"","node-key":"id"}})],1)],1)],1),e._v(" "),t("div",{staticClass:"block"},[t("el-form",{attrs:{model:e.currentRole,"label-width":"80px","label-position":"top"}},[t("el-form-item",{attrs:{label:"Permissions"}},[t("el-tree",{ref:"otherPermissions",staticClass:"permission-tree",attrs:{data:e.otherPermissions,"default-checked-keys":e.permissionKeys(e.roleOtherPermissions),props:e.permissionProps,"show-checkbox":"","node-key":"id"}})],1)],1)],1),e._v(" "),t("div",{staticClass:"clear-left"})]),e._v(" "),t("div",{staticStyle:{"text-align":"right"}},[t("el-button",{attrs:{type:"danger"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("\n          "+e._s(e.$t("permission.cancel"))+"\n        ")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.confirmPermission}},[e._v("\n          "+e._s(e.$t("permission.confirm"))+"\n        ")])],1)])]),e._v(" "),t("el-dialog",{attrs:{visible:e.addDialogVisible,title:e.$t("role.createTitle")||"Create New Role"},on:{"update:visible":function(t){e.addDialogVisible=t}}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.dialogLoading,expression:"dialogLoading"}],staticClass:"form-container"},[t("el-form",{attrs:{model:e.newRole,"label-position":"top","label-width":"100px"}},[t("el-form-item",{attrs:{label:e.$t("role.name")||"Role Name"}},[t("el-input",{model:{value:e.newRole.name,callback:function(t){e.$set(e.newRole,"name",t)},expression:"newRole.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"Menus"}},[t("el-tree",{ref:"newMenuPermissions",staticClass:"permission-tree",attrs:{data:e.menuPermissions,props:e.permissionProps,"show-checkbox":"","node-key":"id"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"Permissions"}},[t("el-tree",{ref:"newOtherPermissions",staticClass:"permission-tree",attrs:{data:e.otherPermissions,props:e.permissionProps,"show-checkbox":"","node-key":"id"}})],1)],1),e._v(" "),t("div",{staticStyle:{"text-align":"right"}},[t("el-button",{attrs:{type:"danger"},on:{click:function(t){e.addDialogVisible=!1}}},[e._v("\n          "+e._s(e.$t("permission.cancel")||"Cancel")+"\n        ")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.submitNewRole}},[e._v("\n          "+e._s(e.$t("role.create")||"Create")+"\n        ")])],1)],1)])],1)},[],!1,null,"dfbd1b44",null).exports},7148:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(6798),i=n.n(r)()(function(e){return e[1]});i.push([e.id,".permissions-container[data-v-dfbd1b44]{flex:1;font-size:14px;justify-content:space-between;padding-right:8px}.permissions-container .block[data-v-dfbd1b44]{float:left;min-width:250px}.permissions-container .clear-left[data-v-dfbd1b44]{clear:left}",""]);const o=i},9884:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(6882);const i={inserted:function(e,t,n){var i=t.value,o=r.A.getters&&r.A.getters.permissions;if(!(i&&i instanceof Array&&i.length>0))throw new Error("Permissions are required! Example: v-permission=\"['manage user','manage permission']\"");var s=i,a=o.some(function(e){return s.includes(e)});a||e.parentNode&&e.parentNode.removeChild(e)}};var o=function(e){e.directive("permission",i)};window.Vue&&(window.permission=i,Vue.use(o)),i.install=o;const s=i},9919:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(6882);function i(e){if(e&&e instanceof Array&&e.length>0){var t=r.A.getters&&r.A.getters.permissions,n=e;return t.some(function(e){return n.includes(e)})}return console.error("Need permissions! Like v-permission=\"['manage permission','edit article']\""),!1}}}]);